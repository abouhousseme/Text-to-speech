<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تحويل النص إلى صوت</title>
    <script src="https://code.responsivevoice.org/responsivevoice.js?key=CfkT9jug"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap');
        body {
            font-family: 'Cairo', sans-serif;
            background-color: #f4f4f4;
            text-align: center;
            padding: 20px;
            border: 10px solid #333;
            width: 90%;
            margin: auto;
            border-radius: 10px;
            background-image: url('https://www.transparenttextures.com/patterns/diamond-upholstery.png');
            direction: rtl;
        }
        h1 {
            color: blue;
            font-size: 28px;
        }
        textarea {
            width: 90%;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid #333;
            border-radius: 10px;
            font-size: 20px;
            text-align: right;
            display: block;
            margin-right: auto;
            margin-left: auto;
        }
        select, button, input {
            width: 45%;
            padding: 15px;
            margin: 10px;
            border: 2px solid #333;
            border-radius: 10px;
            font-size: 20px;
        }
        .button-container {
            display: flex;
            justify-content: center;
            gap: 20px;
        }
        button {
            background-color: #007bff;
            color: white;
            cursor: pointer;
            font-size: 22px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .moving-box {
            position: absolute;
            top: 80px;
            left: 0;
            width: 150px;
            height: 50px;
            background-color: #ff6347;
            color: white;
            line-height: 50px;
            text-align: center;
            border-radius: 10px;
            font-size: 18px;
            display: none;
        }
        .language-switch {
            margin-bottom: 20px;
        }
        .language-switch select {
            width: auto;
            padding: 10px;
            font-size: 18px;
        }
    </style>
</head>
<body>
    <!-- تغيير اللغة -->
    <div class="language-switch">
        <label for="languageSelect">اختر اللغة:</label>
        <select id="languageSelect" onchange="changeLanguage()">
            <option value="ar">العربية</option>
            <option value="en">English</option>
        </select>
    </div>

    <!-- شعار التطبيق -->
    <img id="logo" src="logo.png" alt="Logo">

    <div id="appContent">
        <h1 id="greeting">مرحبًا بك في تطبيق تحويل النص إلى صوت</h1>
        <textarea name="text" id="textToConvert" placeholder="أدخل النص هنا" rows="6"></textarea>

        <div class="button-container">
            <label for="gender" id="genderLabel">اختر الجنس:</label>
            <select id="gender" name="gender">
                <option value="male">ذكر</option>
                <option value="female">أنثى</option>
            </select>

            <label for="speed" id="speedLabel">سرعة الصوت:</label>
            <input type="range" id="speed" name="speed" min="0.5" max="2" step="0.1" value="1">
        </div>

        <button type="button" onclick="convertTextToVoice()" id="convertButton">تحويل النص إلى صوت</button>
        <button type="button" onclick="downloadAudio()" id="downloadButton">تحميل الصوت</button>
    </div>

    <!-- نافذة متحركة -->
    <div id="movingBox" class="moving-box">جاري التشغيل...</div>

    <script>
        function changeLanguage() {
            const selectedLanguage = document.getElementById('languageSelect').value;
            if (selectedLanguage === 'en') {
                document.documentElement.lang = 'en';
                document.documentElement.dir = 'ltr';
                document.getElementById('greeting').textContent = 'Welcome to the Text-to-Speech App';
                document.getElementById('textToConvert').placeholder = 'Enter text here';
                document.getElementById('genderLabel').textContent = 'Select Gender:';
                document.getElementById('speedLabel').textContent = 'Speech Speed:';
                document.getElementById('convertButton').textContent = 'Convert Text to Speech';
                document.getElementById('downloadButton').textContent = 'Download Audio';
            } else {
                document.documentElement.lang = 'ar';
                document.documentElement.dir = 'rtl';
                document.getElementById('greeting').textContent = 'مرحبًا بك في تطبيق تحويل النص إلى صوت';
                document.getElementById('textToConvert').placeholder = 'أدخل النص هنا';
                document.getElementById('genderLabel').textContent = 'اختر الجنس:';
                document.getElementById('speedLabel').textContent = 'سرعة الصوت:';
                document.getElementById('convertButton').textContent = 'تحويل النص إلى صوت';
                document.getElementById('downloadButton').textContent = 'تحميل الصوت';
            }
        }

        function convertTextToVoice() {
            const text = document.getElementById('textToConvert').value;
            const gender = document.getElementById('gender').value;
            const speed = document.getElementById('speed').value;
            const voice = gender === "female" ? "Arabic Female" : "Arabic Male";

            // تقدير مدة الصوت بناءً على طول النص وسرعة الصوت
            const estimatedDuration = text.length / (speed * 10); // تقدير بسيط
            const movingBox = document.getElementById('movingBox');
            
            // تشغيل النص كصوت
            responsiveVoice.speak(text, voice, { rate: speed });

            // عرض النافذة المتحركة
            movingBox.style.display = 'block';
            movingBox.style.left = '0px'; // بدء الحركة من اليسار

            // حركة النافذة
            let startTime = null;
            const animationDuration = estimatedDuration * 1000; // تحويل المدة إلى مللي ثانية

            function animateBox(timestamp) {
                if (!startTime) startTime = timestamp;
                const elapsed = timestamp - startTime;

                // حساب الموضع الجديد بناءً على الوقت
                const progress = Math.min(elapsed / animationDuration, 1);
                const windowWidth = window.innerWidth - 150; // عرض الشاشة - عرض النافذة المتحركة
                movingBox.style.left = progress * windowWidth + 'px';

                if (progress < 1) {
                    requestAnimationFrame(animateBox);
                } else {
                    movingBox.style.display = 'none'; // إخفاء النافذة بعد انتهاء الحركة
                }
            }

            requestAnimationFrame(animateBox);
        }

        function downloadAudio() {
            const text = document.getElementById('textToConvert').value;
            const gender = document.getElementById('gender').value;
            const voice = gender === "female" ? "Arabic Female" : "Arabic Male";

            const audioBlob = new Blob([text], { type: 'audio/wav' });
            const url = URL.createObjectURL(audioBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'audio.wav';
            link.click();
        }
    </script>
</body>
</html>
