async function subscribe(event) {
    event.preventDefault();  // Prevent the default form submission

    const username = document.getElementById("name").value;
    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;

    if (!username || !email || !password) {
        alert('الرجاء ملء جميع الحقول!');
        return;
    }

    try {
        const response = await fetch('/api/subscribe', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ name: username, email, password })
        });

        // طباعة الاستجابة للنظر في محتواها
        const text = await response.text(); // قراءة النص بدل JSON
        console.log('Response text:', text);

        // إذا كانت الاستجابة لا تحتوي على JSON، التعامل مع الخطأ
        if (!response.ok) {
            alert('حدث خطأ: ' + text);
            return;
        }

        // محاولة تحويل النص إلى JSON فقط إذا كان هناك استجابة صحيحة
        const result = JSON.parse(text);

        if (response.ok) {
            alert('تم التسجيل بنجاح! تابع بريدك الإلكتروني للتأكد من التفعيل.');
            window.location.href = '/activation-info.html';
        } else {
            alert(result.message);
        }
    } catch (error) {
        console.error('خطأ أثناء محاولة التسجيل:', error);
        alert('حدث خطأ، يرجى المحاولة لاحقًا.');
    }
}
